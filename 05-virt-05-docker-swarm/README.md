# Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"


---

## Задача 1

Дайте письменые ответы на следующие вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
- Какой алгоритм выбора лидера используется в Docker Swarm кластере?
- Что такое Overlay Network?

Ответ:  
  1. В случае, когда указан mode global, то сервис запустится не всех нодах, в случае с replication - только на тех нодах, на которых мы указали в конфиге.
  2. Алгоритм RAFT - алгоритм построен на распределенном консенсусе, то есть в единицу времени, как минимум две ноды участвуют, отправляют заявку на лидерство, тот кто первый ответил, то становится лидером. Дальше в работе ноды между собой посылают запросы, чтобы определить доступен ли лидер и отвечает ли он до сих пор самый первый, в случае, когда лидер не ответил в заданное время идет пересогласование по тому же принципу. попытался дать пояснения своими словами
  3. Overlay Network - распределенная сеть кластера, которая позволяет общаться контейнерам между собой на разных нодах, возможно шифрование трафика. docker engine в рамках такой сети, сам занимается маршрутизацией.  
 
## Задача 2

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker node ls
```
Ответ:  

![image](https://user-images.githubusercontent.com/26147777/164477683-e2dd301c-a5b9-418a-b8a4-01b1956635e5.png)


## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```
Ответ:  

![image](https://user-images.githubusercontent.com/26147777/164492302-55d620ec-4f38-46e1-b0bb-370c25eb8c9c.png)


## Задача 4 (*)

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true  

Ответ:  
Эта функция называется автоматической блокировкой.
Когда Docker перезапускается, и ключ TLS, используемый для шифрования связи между узлами, и ключ, используемый для шифрования и дешифрования журналов Raft на диске, загружаются в память каждого узла менеджера. В Docker 1.13 появилась возможность защитить ключ взаимного шифрования TLS и ключ, используемый для шифрования и дешифрования журналов Raft в состоянии покоя, что позволяет вам вступать во владение этими ключами и требовать ручную разблокировку ваших менеджеров. Эта функция называется автоматической блокировкой .

Когда Docker перезапускается, вы должны сначала разблокировать Swarm , используя ключ шифрования ключа, сгенерированный Docker, когда рой был заблокирован. 
```

